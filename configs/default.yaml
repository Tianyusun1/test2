# Poem2Layout Configuration

model:
  # BERT encoder
  bert_path: "/home/610-sty/huggingface/bert-base-chinese"
  hidden_size: 768  # BERT hidden size
  # Layout decoder
  bb_size: 64       # Layout embedding size (for cls + bbox). 必须等于 cls_embed_dim + 4 * bbox_embed_dim
  decoder_layers: 4
  decoder_heads: 8
  dropout: 0.1
  # Output
  num_classes: 9    # 2~10 mapped to 0~8
  
  # --- DISCRETE BBOX PARAMETERS (NEW) ---
  num_bbox_bins: 1000       # BBox 坐标离散化为 1000 个 bins (范围 [0, 999])
  cls_embed_dim: 16         # 类别 token (CLS/BOS/EOS) 的嵌入维度
  bbox_embed_dim: 12        # 每个坐标 token (cx, cy, w, h) 的嵌入维度 (16 + 4*12 = 64)
  iou_loss_weight: 1.0      # 提高 IoU 损失权重，以强制模型解决堆叠问题
  # --------------------------------------
  
  coord_loss_weight: 1.0 # 权重现在应用于 BBox 分类损失 (CrossEntropy)
  # Inference
  max_elements: 30  # Max number of elements to generate
  # Data paths
  xlsx_path: "/home/610-sty/Layout2Paint/dataset/6800poems.xlsx"
  images_dir: "/home/610-sty/Layout2Paint/dataset/6800"
  labels_dir: "/home/610-sty/Layout2Paint/dataset/6800/JPEGImages-pre_new_txt"
  max_layout_length: 30
  max_text_length: 64

training:
  batch_size: 16
  epochs: 100
  learning_rate: 0.00005 # 采用较低学习率以增强离散模型的稳定性
  warmup_steps: 1000
  save_every: 10
  output_dir: "./outputs"
  log_steps: 10

inference:
  max_output_length: 30
  # beam_size: 1  # Only greedy for now