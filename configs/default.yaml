# File: tianyusun1/test2/test2-4.0/configs/default.yaml (V5.3: NO AESTHETIC LOSS + HIGH DIMENSION)

model:
  # BERT encoder
  bert_path: "/home/610-sty/huggingface/bert-base-chinese"
  hidden_size: 768
  # Layout decoder
  bb_size: 128            # [MODIFIED V5.3] 增大维度至 128，提升特征容量
  decoder_layers: 6
  decoder_heads: 8
  dropout: 0.3
  # Output
  num_classes: 9
  
  # === [NEW] CVAE Parameters ===
  latent_dim: 32  # [NEW] 隐变量维度，决定了“想象力”的空间大小
  
  # --- Legacy Discrete Parameters (保留以防报错，但不再核心使用) ---
  num_bbox_bins: 1000
  cls_embed_dim: 32
  bbox_embed_dim: 24
  # -----------------------------------------------------------

  # === LOSS WEIGHTS (INITIAL VALUES FOR CURRICULUM) ===
  # 注意：trainer.py 的双重课程学习策略会动态调整 reg/rel/overlap 权重。
  
  # 1. 弱化 GT 监督 (初始阶段)
  reg_loss_weight: 1.0      # [CURRICULUM START] 初始低权重，后期动态升至 5.0
  iou_loss_weight: 1.0      # [LOWERED] 保持较低，避免初期干扰逻辑学习
  area_loss_weight: 1.0     
  
  # 2. 强化 KG 与 常识约束
  relation_loss_weight: 5.0 # [CURRICULUM START] 初始高权重，后期动态降至 3.0 (保底逻辑)
  
  # 3. 空间合理性
  overlap_loss_weight: 3.0  
  size_loss_weight: 2.0     # [NEW] 统计约束：物体越多，框应该越小
  
  # 4. [NEW V5.3] 审美约束 (Aesthetic Losses)
  # [CRITICAL] 彻底关闭审美约束，防止模型陷入“中轴线死锁”。
  # 先让模型学会“乱跑”（多样性），以后再微调“美感”。
  alignment_loss_weight: 0.0 # [V5.3] 设为 0，允许不对称构图
  balance_loss_weight: 0.0   # [V5.3] 设为 0，允许重心偏离中心
  
  # Legacy weights (可以保留或设为0)
  coord_loss_weight: 0.0    
  cls_loss_weight: 0.0      # Query-Based 不需要分类损失
  count_loss_weight: 0.0    # Query-Based 不需要计数损失

  # Inference
  max_elements: 30
  
  # Data paths
  xlsx_path: "/home/610-sty/Layout2Paint/dataset/6800poems.xlsx"
  images_dir: "/home/610-sty/Layout2Paint/dataset/6800"
  labels_dir: "/home/610-sty/Layout2Paint/dataset/6800/JPEGImages-pre_new_txt"
  max_layout_length: 30
  max_text_length: 64

training:
  batch_size: 16
  epochs: 200             # [MODIFIED] 缩短为 200 Epochs，配合加速的课程学习
  learning_rate: 0.0001
  warmup_steps: 1000
  save_every: 50
  output_dir: "./outputs"
  log_steps: 10
  visualize_every: 1      # 保持高频可视化以便观察

inference:
  max_output_length: 30