# File: tianyusun1/test2/test2-5.1/configs/default.yaml (V5.4: +CLUSTERING LOSS)
#5.2版本引入数量问题

model:
  # BERT encoder
  bert_path: "/home/610-sty/huggingface/bert-base-chinese"
  hidden_size: 768
  # Layout decoder
  bb_size: 128            # 保持 V5.3 的高维度
  decoder_layers: 6
  decoder_heads: 8
  dropout: 0.3
  # Output
  num_classes: 9
  
  # === CVAE Parameters ===
  latent_dim: 32  
  
  # --- Legacy Discrete Parameters ---
  num_bbox_bins: 1000
  cls_embed_dim: 32
  bbox_embed_dim: 24
  # -----------------------------------------------------------

  # === LOSS WEIGHTS (INITIAL VALUES FOR CURRICULUM) ===
  # Trainer 会动态调整 reg/rel/overlap 权重。
  
  # 1. 基础重建
  reg_loss_weight: 1.0      # [CURRICULUM] 初始 1.0 -> 后期 5.0
  iou_loss_weight: 1.0      
  area_loss_weight: 1.0     
  
  # 2. 逻辑与空间约束
  relation_loss_weight: 5.0 # [CURRICULUM] 初始 5.0 -> 后期 1.0
  overlap_loss_weight: 3.0  
  size_loss_weight: 2.0     
  
  # 3. [NEW V5.4] 聚类约束 (Clustering Loss)
  # 防止同类物体（如两只鸟）散列太远。权重设为 1.0 作为起始尝试。
  clustering_loss_weight: 1.0
  
  # 4. 审美约束 (Aesthetic Losses)
  # 暂时关闭，优先保证生成的物体数量和聚类正确。
  alignment_loss_weight: 0.0 
  balance_loss_weight: 0.0   
  
  # Legacy weights
  coord_loss_weight: 0.0    
  cls_loss_weight: 0.0      
  count_loss_weight: 0.0    

  # Inference
  max_elements: 30
  
  # Data paths
  xlsx_path: "/home/610-sty/Layout2Paint/dataset/6800poems.xlsx"
  images_dir: "/home/610-sty/Layout2Paint/dataset/6800"
  labels_dir: "/home/610-sty/Layout2Paint/dataset/6800/JPEGImages-pre_new_txt"
  max_layout_length: 30
  max_text_length: 64

training:
  batch_size: 16
  epochs: 200             
  learning_rate: 0.0001
  warmup_steps: 1000
  save_every: 50
  output_dir: "./outputs"
  log_steps: 10
  visualize_every: 1      # 保持高频可视化以便观察 "Epoch X Layout Pred"

inference:
  max_output_length: 30